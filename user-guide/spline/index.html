
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Fast multi-dimensional Chebyshev tensor interpolation with analytical derivatives">
      
      
      
      
        <link rel="prev" href="../sliding/">
      
      
        <link rel="next" href="../tensor-train/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Chebyshev Splines - PyChebyshev</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chebyshev-splines" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="PyChebyshev" class="md-header__button md-logo" aria-label="PyChebyshev" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PyChebyshev
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chebyshev Splines
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/0xC000005/PyChebyshev" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    PyChebyshev
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="PyChebyshev" class="md-nav__button md-logo" aria-label="PyChebyshev" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    PyChebyshev
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/0xC000005/PyChebyshev" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    PyChebyshev
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    User Guide
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    User Guide
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mathematical Concepts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Usage Patterns
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../serialization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Saving & Loading
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../greeks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Computing Greeks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sliding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sliding Technique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Chebyshev Splines
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Chebyshev Splines
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-gibbs-phenomenon" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Gibbs Phenomenon
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-piecewise-chebyshev-restores-spectral-convergence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why Piecewise Chebyshev Restores Spectral Convergence
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Why Piecewise Chebyshev Restores Spectral Convergence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-bernstein-ellipse" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Bernstein ellipse
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-kinks-destroy-analyticity" class="md-nav__link">
    <span class="md-ellipsis">
      
        How kinks destroy analyticity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-splitting-restores-it" class="md-nav__link">
    <span class="md-ellipsis">
      
        How splitting restores it
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick Start
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#choosing-knots" class="md-nav__link">
    <span class="md-ellipsis">
      
        Choosing Knots
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multiple-knots-and-multi-dimensional-problems" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multiple Knots and Multi-Dimensional Problems
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Multiple Knots and Multi-Dimensional Problems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#multiple-knots-in-one-dimension" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multiple knots in one dimension
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-dimensional-knots" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multi-dimensional knots
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#no-knots-in-a-dimension" class="md-nav__link">
    <span class="md-ellipsis">
      
        No knots in a dimension
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#degenerate-case-no-knots-at-all" class="md-nav__link">
    <span class="md-ellipsis">
      
        Degenerate case: no knots at all
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#derivatives" class="md-nav__link">
    <span class="md-ellipsis">
      
        Derivatives
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Derivatives">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#derivatives-at-knot-boundaries" class="md-nav__link">
    <span class="md-ellipsis">
      
        Derivatives at knot boundaries
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-estimation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Estimation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#when-to-use-chebyshevspline" class="md-nav__link">
    <span class="md-ellipsis">
      
        When to Use ChebyshevSpline
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#batch-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Batch Evaluation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#serialization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Serialization
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limitations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Limitations
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        API Reference
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline" class="md-nav__link">
    <span class="md-ellipsis">
      
        ChebyshevSpline
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.num_pieces" class="md-nav__link">
    <span class="md-ellipsis">
      
        num_pieces
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.total_build_evals" class="md-nav__link">
    <span class="md-ellipsis">
      
        total_build_evals
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.build_time" class="md-nav__link">
    <span class="md-ellipsis">
      
        build_time
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.build" class="md-nav__link">
    <span class="md-ellipsis">
      
        build
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.eval" class="md-nav__link">
    <span class="md-ellipsis">
      
        eval
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.eval_multi" class="md-nav__link">
    <span class="md-ellipsis">
      
        eval_multi
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.eval_batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        eval_batch
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.error_estimate" class="md-nav__link">
    <span class="md-ellipsis">
      
        error_estimate
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.__getstate__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __getstate__
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.__setstate__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __setstate__
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        save
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        load
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.nodes" class="md-nav__link">
    <span class="md-ellipsis">
      
        nodes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.from_values" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_values
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.extrude" class="md-nav__link">
    <span class="md-ellipsis">
      
        extrude
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.slice" class="md-nav__link">
    <span class="md-ellipsis">
      
        slice
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.integrate" class="md-nav__link">
    <span class="md-ellipsis">
      
        integrate
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.roots" class="md-nav__link">
    <span class="md-ellipsis">
      
        roots
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.minimize" class="md-nav__link">
    <span class="md-ellipsis">
      
        minimize
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.maximize" class="md-nav__link">
    <span class="md-ellipsis">
      
        maximize
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tensor-train/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tensor Train
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chebyshev Algebra
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extrude-slice/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Extrusion & Slicing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../calculus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chebyshev Calculus
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../from-values/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pre-computed Values
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../error-estimation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Error Estimation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Benchmarks
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-gibbs-phenomenon" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Gibbs Phenomenon
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-piecewise-chebyshev-restores-spectral-convergence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why Piecewise Chebyshev Restores Spectral Convergence
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Why Piecewise Chebyshev Restores Spectral Convergence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-bernstein-ellipse" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Bernstein ellipse
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-kinks-destroy-analyticity" class="md-nav__link">
    <span class="md-ellipsis">
      
        How kinks destroy analyticity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-splitting-restores-it" class="md-nav__link">
    <span class="md-ellipsis">
      
        How splitting restores it
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick Start
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#choosing-knots" class="md-nav__link">
    <span class="md-ellipsis">
      
        Choosing Knots
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multiple-knots-and-multi-dimensional-problems" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multiple Knots and Multi-Dimensional Problems
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Multiple Knots and Multi-Dimensional Problems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#multiple-knots-in-one-dimension" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multiple knots in one dimension
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-dimensional-knots" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multi-dimensional knots
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#no-knots-in-a-dimension" class="md-nav__link">
    <span class="md-ellipsis">
      
        No knots in a dimension
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#degenerate-case-no-knots-at-all" class="md-nav__link">
    <span class="md-ellipsis">
      
        Degenerate case: no knots at all
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#derivatives" class="md-nav__link">
    <span class="md-ellipsis">
      
        Derivatives
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Derivatives">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#derivatives-at-knot-boundaries" class="md-nav__link">
    <span class="md-ellipsis">
      
        Derivatives at knot boundaries
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-estimation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Estimation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#when-to-use-chebyshevspline" class="md-nav__link">
    <span class="md-ellipsis">
      
        When to Use ChebyshevSpline
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#batch-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Batch Evaluation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#serialization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Serialization
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limitations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Limitations
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        API Reference
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline" class="md-nav__link">
    <span class="md-ellipsis">
      
        ChebyshevSpline
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.num_pieces" class="md-nav__link">
    <span class="md-ellipsis">
      
        num_pieces
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.total_build_evals" class="md-nav__link">
    <span class="md-ellipsis">
      
        total_build_evals
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.build_time" class="md-nav__link">
    <span class="md-ellipsis">
      
        build_time
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.build" class="md-nav__link">
    <span class="md-ellipsis">
      
        build
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.eval" class="md-nav__link">
    <span class="md-ellipsis">
      
        eval
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.eval_multi" class="md-nav__link">
    <span class="md-ellipsis">
      
        eval_multi
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.eval_batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        eval_batch
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.error_estimate" class="md-nav__link">
    <span class="md-ellipsis">
      
        error_estimate
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.__getstate__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __getstate__
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.__setstate__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __setstate__
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        save
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        load
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.nodes" class="md-nav__link">
    <span class="md-ellipsis">
      
        nodes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.from_values" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_values
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.extrude" class="md-nav__link">
    <span class="md-ellipsis">
      
        extrude
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.slice" class="md-nav__link">
    <span class="md-ellipsis">
      
        slice
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.integrate" class="md-nav__link">
    <span class="md-ellipsis">
      
        integrate
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.roots" class="md-nav__link">
    <span class="md-ellipsis">
      
        roots
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.minimize" class="md-nav__link">
    <span class="md-ellipsis">
      
        minimize
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychebyshev.spline.ChebyshevSpline.maximize" class="md-nav__link">
    <span class="md-ellipsis">
      
        maximize
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="chebyshev-splines">Chebyshev Splines<a class="headerlink" href="#chebyshev-splines" title="Permanent link">&para;</a></h1>
<h2 id="the-gibbs-phenomenon">The Gibbs Phenomenon<a class="headerlink" href="#the-gibbs-phenomenon" title="Permanent link">&para;</a></h2>
<p>Chebyshev interpolation converges <strong>exponentially</strong> for smooth (analytic) functions
-- this is the spectral advantage that makes the method so powerful.  But when the
target function has a <strong>discontinuity</strong> or a <strong>kink</strong>, this advantage disappears.</p>
<p><strong>Jump discontinuities.</strong>  For a function <span class="arithmatex">\(f\)</span> with a jump discontinuity at
<span class="arithmatex">\(c \in (a, b)\)</span>, the Chebyshev interpolant converges only as <span class="arithmatex">\(O(1/n)\)</span> pointwise
away from <span class="arithmatex">\(c\)</span>.  Near <span class="arithmatex">\(c\)</span>, oscillations persist regardless of how many nodes you
add -- this is the classical <strong>Gibbs phenomenon</strong>.</p>
<p><strong>Kinks.</strong>  For a function that is continuous but whose derivative is discontinuous
at <span class="arithmatex">\(c\)</span> -- for example <span class="arithmatex">\(|x|\)</span> at <span class="arithmatex">\(x = 0\)</span> or a call payoff
<span class="arithmatex">\(\max(S - K, 0)\)</span> at <span class="arithmatex">\(S = K\)</span> -- the situation is better but still algebraic:
convergence is <span class="arithmatex">\(O(1/n^2)\)</span> instead of exponential.  This means that increasing
the node count from 15 to 30 only halves the error, rather than reducing it by
orders of magnitude as it would for a smooth function.</p>
<div class="admonition example">
<p class="admonition-title">Interpolating <span class="arithmatex">\(|x|\)</span> on <span class="arithmatex">\([-1, 1]\)</span></p>
<p>With global Chebyshev interpolation, the error near <span class="arithmatex">\(x = 0\)</span> plateaus at
approximately <span class="arithmatex">\(0.01\)</span> regardless of whether you use 10, 20, or 40 nodes.
This is exactly the algebraic <span class="arithmatex">\(O(1/n^2)\)</span> convergence rate -- the spectral
advantage of Chebyshev is lost.</p>
</div>
<p>In quantitative finance this problem is ubiquitous: option payoffs have kinks at
strike prices, barrier levels, and exercise boundaries.  Applying global Chebyshev
interpolation to such functions wastes nodes fighting the Gibbs oscillations instead
of refining the smooth parts of the function.</p>
<h2 id="why-piecewise-chebyshev-restores-spectral-convergence">Why Piecewise Chebyshev Restores Spectral Convergence<a class="headerlink" href="#why-piecewise-chebyshev-restores-spectral-convergence" title="Permanent link">&para;</a></h2>
<p>The key to understanding why piecewise interpolation helps lies in the
<strong>Bernstein ellipse theorem</strong>.</p>
<h3 id="the-bernstein-ellipse">The Bernstein ellipse<a class="headerlink" href="#the-bernstein-ellipse" title="Permanent link">&para;</a></h3>
<p>For a function <span class="arithmatex">\(f\)</span> analytic in the interior of the <strong>Bernstein ellipse</strong>
<span class="arithmatex">\(\mathcal{E}_\rho\)</span> -- the ellipse in the complex plane with foci at <span class="arithmatex">\(\pm 1\)</span>
and semi-axis sum <span class="arithmatex">\(\rho &gt; 1\)</span> -- the Chebyshev interpolation error on <span class="arithmatex">\([-1, 1]\)</span>
with <span class="arithmatex">\(n\)</span> nodes satisfies:</p>
<div class="arithmatex">\[
\| f - p_n \|_\infty \leq \frac{2 M}{\rho^n (\rho - 1)}
\]</div>
<p>where <span class="arithmatex">\(M = \max_{z \in \mathcal{E}_\rho} |f(z)|\)</span>.  The rate <span class="arithmatex">\(\rho^{-n}\)</span> is
<strong>exponential</strong> in <span class="arithmatex">\(n\)</span> -- this is spectral convergence.</p>
<h3 id="how-kinks-destroy-analyticity">How kinks destroy analyticity<a class="headerlink" href="#how-kinks-destroy-analyticity" title="Permanent link">&para;</a></h3>
<p>A function with a kink at <span class="arithmatex">\(c\)</span> is <strong>not analytic</strong> at <span class="arithmatex">\(c\)</span>.  The Bernstein
ellipse cannot extend past the singularity: it collapses to the real interval
near <span class="arithmatex">\(c\)</span>, forcing <span class="arithmatex">\(\rho \to 1\)</span> and reducing convergence to algebraic.</p>
<h3 id="how-splitting-restores-it">How splitting restores it<a class="headerlink" href="#how-splitting-restores-it" title="Permanent link">&para;</a></h3>
<p>By placing a <strong>knot</strong> at <span class="arithmatex">\(c\)</span> and interpolating each sub-interval separately,
each piece sees a <strong>smooth</strong> function:</p>
<ul>
<li><span class="arithmatex">\(|x|\)</span> restricted to <span class="arithmatex">\([-1, 0]\)</span> is just <span class="arithmatex">\(-x\)</span>, which is entire (analytic
  everywhere in <span class="arithmatex">\(\mathbb{C}\)</span>).</li>
<li><span class="arithmatex">\(|x|\)</span> restricted to <span class="arithmatex">\([0, 1]\)</span> is just <span class="arithmatex">\(x\)</span>, also entire.</li>
</ul>
<p>Each piece has a large Bernstein ellipse parameter <span class="arithmatex">\(\rho_k \gg 1\)</span>, and the error
on piece <span class="arithmatex">\(k\)</span> with <span class="arithmatex">\(n\)</span> Chebyshev nodes is:</p>
<div class="arithmatex">\[
E_k \leq \frac{2 M_k}{\rho_k^n (\rho_k - 1)}
\]</div>
<p>where <span class="arithmatex">\(M_k = \max_{z \in \mathcal{E}_{\rho_k}} |f(z)|\)</span> on that piece's Bernstein
ellipse.  Because pieces cover disjoint sub-domains, the overall interpolation error
is:</p>
<div class="arithmatex">\[
\| f - \mathcal{S}_n f \|_\infty = \max_k \, E_k
\]</div>
<p>This is exponential in <span class="arithmatex">\(n\)</span> -- <strong>spectral convergence is restored</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Book reference</p>
<p>The Chebyshev Spline technique is described in Section 3.8 of Ruiz &amp; Zeron
(2021), <em>Machine Learning for Risk Calculations</em>, Wiley Finance.  The book
demonstrates that pricing a European call near the strike kink requires 95
nodes with global Chebyshev but only 25 nodes (split into two pieces at
<span class="arithmatex">\(K\)</span>) with a Chebyshev spline -- same accuracy, 4x fewer evaluations.</p>
</div>
<h2 id="quick-start">Quick Start<a class="headerlink" href="#quick-start" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pychebyshev</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChebyshevSpline</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># European call payoff max(S - K, 0) * exp(-rT) with kink at K = 100</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">payoff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="c1"># Place a knot at S = 100 (the strike), no knots in the T dimension</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">spline</span> <span class="o">=</span> <span class="n">ChebyshevSpline</span><span class="p">(</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">payoff</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="n">num_dimensions</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">domain</span><span class="o">=</span><span class="p">[[</span><span class="mi">80</span><span class="p">,</span> <span class="mi">120</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]],</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">n_nodes</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="n">knots</span><span class="o">=</span><span class="p">[[</span><span class="mf">100.0</span><span class="p">],</span> <span class="p">[]],</span>   <span class="c1"># knot at S=K, none in T</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="p">)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="n">spline</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="c1"># Evaluate in-the-money</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="n">price_itm</span> <span class="o">=</span> <span class="n">spline</span><span class="o">.</span><span class="n">eval</span><span class="p">([</span><span class="mf">110.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="c1"># Evaluate out-of-the-money</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="n">price_otm</span> <span class="o">=</span> <span class="n">spline</span><span class="o">.</span><span class="n">eval</span><span class="p">([</span><span class="mf">90.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="c1"># Delta (dV/dS) on the in-the-money side</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="n">delta</span> <span class="o">=</span> <span class="n">spline</span><span class="o">.</span><span class="n">eval</span><span class="p">([</span><span class="mf">110.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="nb">print</span><span class="p">(</span><span class="n">spline</span><span class="p">)</span>
</code></pre></div>
<p>Output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>ChebyshevSpline (2D, built)
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>  Nodes:       [15, 15] per piece
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>  Knots:       [[100.0], []]
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>  Pieces:      2 (2 x 1)
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>  Build:       0.012s (450 function evals)
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>  Domain:      [80, 120] x [0.25, 1.0]
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>  Error est:   1.23e-10
</code></pre></div>
<p>With global <code>ChebyshevApproximation</code> on the same domain, you would need
approximately 95 nodes to achieve similar accuracy.  The spline uses 2 pieces
of 15 nodes each (450 total evaluations vs. 9,025).</p>
<h2 id="choosing-knots">Choosing Knots<a class="headerlink" href="#choosing-knots" title="Permanent link">&para;</a></h2>
<p>Place knots at the locations where the function is <strong>non-smooth</strong>:</p>
<table>
<thead>
<tr>
<th>Singularity type</th>
<th>Example</th>
<th>Knot location</th>
</tr>
</thead>
<tbody>
<tr>
<td>Payoff kink</td>
<td>European call <span class="arithmatex">\(\max(S - K, 0)\)</span></td>
<td><span class="arithmatex">\(S = K\)</span></td>
</tr>
<tr>
<td>Barrier level</td>
<td>Knock-out option</td>
<td><span class="arithmatex">\(S = B\)</span></td>
</tr>
<tr>
<td>Exercise boundary</td>
<td>American option (if known)</td>
<td><span class="arithmatex">\(S = S^*(T)\)</span></td>
</tr>
<tr>
<td>Absolute value</td>
<td><span class="arithmatex">\(\|x\|\)</span></td>
<td><span class="arithmatex">\(x = 0\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Guidelines:</strong></p>
<ul>
<li><strong>Only add knots where the function is non-smooth.</strong>  For smooth functions,
  knots provide no benefit -- you pay extra build cost for no accuracy gain.</li>
<li><strong>More knots = more pieces = more build evaluations.</strong>  Each dimension with
  <span class="arithmatex">\(k_d\)</span> interior knots creates <span class="arithmatex">\(k_d + 1\)</span> sub-intervals.  The total number
  of pieces is the Cartesian product <span class="arithmatex">\(\prod_d (k_d + 1)\)</span>.</li>
<li><strong>Knots must be known a priori.</strong>  <code>ChebyshevSpline</code> does not detect
  singularities automatically; you must specify where they are.</li>
</ul>
<h2 id="multiple-knots-and-multi-dimensional-problems">Multiple Knots and Multi-Dimensional Problems<a class="headerlink" href="#multiple-knots-and-multi-dimensional-problems" title="Permanent link">&para;</a></h2>
<h3 id="multiple-knots-in-one-dimension">Multiple knots in one dimension<a class="headerlink" href="#multiple-knots-in-one-dimension" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># Two knots in dimension 0: at x = -1 and x = 1</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="c1"># This creates 3 pieces in dimension 0</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">spline</span> <span class="o">=</span> <span class="n">ChebyshevSpline</span><span class="p">(</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    <span class="n">my_func</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    <span class="n">domain</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]],</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>    <span class="n">n_nodes</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>    <span class="n">knots</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]],</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="p">)</span>
</code></pre></div>
<h3 id="multi-dimensional-knots">Multi-dimensional knots<a class="headerlink" href="#multi-dimensional-knots" title="Permanent link">&para;</a></h3>
<p>Each dimension has its own independent list of knots.  The total number of pieces
is the Cartesian product of per-dimension intervals:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># 2D: 2 knots in dim 0, 1 knot in dim 1</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="c1"># Pieces: (2+1) x (1+1) = 3 x 2 = 6</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="n">spline</span> <span class="o">=</span> <span class="n">ChebyshevSpline</span><span class="p">(</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    <span class="n">my_func</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    <span class="n">domain</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]],</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    <span class="n">n_nodes</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>    <span class="n">knots</span><span class="o">=</span><span class="p">[[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">]],</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="p">)</span>
</code></pre></div>
<h3 id="no-knots-in-a-dimension">No knots in a dimension<a class="headerlink" href="#no-knots-in-a-dimension" title="Permanent link">&para;</a></h3>
<p>Use an empty list <code>[]</code> for dimensions where the function is smooth:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># Knot at S = 100 in price dimension, none in time or vol</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">spline</span> <span class="o">=</span> <span class="n">ChebyshevSpline</span><span class="p">(</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    <span class="n">bs_func</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    <span class="n">domain</span><span class="o">=</span><span class="p">[[</span><span class="mi">80</span><span class="p">,</span> <span class="mi">120</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">]],</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    <span class="n">n_nodes</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    <span class="n">knots</span><span class="o">=</span><span class="p">[[</span><span class="mf">100.0</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[]],</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="p">)</span>
</code></pre></div>
<h3 id="degenerate-case-no-knots-at-all">Degenerate case: no knots at all<a class="headerlink" href="#degenerate-case-no-knots-at-all" title="Permanent link">&para;</a></h3>
<p>If every dimension has an empty knot list, the spline has exactly one piece and
behaves identically to a plain <code>ChebyshevApproximation</code>.</p>
<h2 id="derivatives">Derivatives<a class="headerlink" href="#derivatives" title="Permanent link">&para;</a></h2>
<p>Within each piece, derivatives are computed <strong>analytically</strong> via spectral
differentiation matrices -- the same mechanism used by <code>ChebyshevApproximation</code>.
No finite differences are needed.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1"># First derivative w.r.t. dimension 0</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">dfdx0</span> <span class="o">=</span> <span class="n">spline</span><span class="o">.</span><span class="n">eval</span><span class="p">([</span><span class="mf">110.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="c1"># Second derivative w.r.t. dimension 0</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="n">d2fdx0</span> <span class="o">=</span> <span class="n">spline</span><span class="o">.</span><span class="n">eval</span><span class="p">([</span><span class="mf">110.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="c1"># Multiple derivatives at once (shared barycentric weights)</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="n">results</span> <span class="o">=</span> <span class="n">spline</span><span class="o">.</span><span class="n">eval_multi</span><span class="p">(</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>    <span class="p">[</span><span class="mf">110.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>    <span class="p">[</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># function value</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># dV/dS</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>        <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># d2V/dS2</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>  <span class="c1"># dV/dT</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>    <span class="p">],</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="p">)</span>
</code></pre></div>
<h3 id="derivatives-at-knot-boundaries">Derivatives at knot boundaries<a class="headerlink" href="#derivatives-at-knot-boundaries" title="Permanent link">&para;</a></h3>
<p>Derivatives are <strong>not defined</strong> at knot boundaries.  At a kink, the left and right
polynomial pieces have different derivative values.  Requesting a derivative at a
knot raises <code>ValueError</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># This raises ValueError:</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="c1"># &quot;Derivative w.r.t. dimension 0 is not defined at knot x[0]=100.0&quot;</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="n">spline</span><span class="o">.</span><span class="n">eval</span><span class="p">([</span><span class="mf">100.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="c1"># Function values are fine at knots:</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="n">spline</span><span class="o">.</span><span class="n">eval</span><span class="p">([</span><span class="mf">100.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>  <span class="c1"># OK</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Evaluate near the knot instead</p>
<p>If you need a derivative near a knot, evaluate slightly to one side:
<code>spline.eval([100.001, 0.5], [1, 0])</code> gives the right-side derivative.</p>
</div>
<h2 id="error-estimation">Error Estimation<a class="headerlink" href="#error-estimation" title="Permanent link">&para;</a></h2>
<p><code>error_estimate()</code> returns the <strong>maximum</strong> error estimate across all pieces:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">spline</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error estimate: </span><span class="si">{</span><span class="n">spline</span><span class="o">.</span><span class="n">error_estimate</span><span class="p">()</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Since pieces cover disjoint sub-domains, the interpolation error at any point is
bounded by the error of the piece containing that point.  The worst-case error is
therefore the <strong>maximum</strong> over all pieces:</p>
<div class="arithmatex">\[
\hat{E} = \max_k \hat{E}_k
\]</div>
<p>This differs from <code>ChebyshevSlider</code>, where all slides contribute to every point
and the error estimate is the <strong>sum</strong> over slides.</p>
<h2 id="when-to-use-chebyshevspline">When to Use ChebyshevSpline<a class="headerlink" href="#when-to-use-chebyshevspline" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Scenario</th>
<th>Recommended class</th>
<th>Why</th>
</tr>
</thead>
<tbody>
<tr>
<td>Smooth function, <span class="arithmatex">\(\leq\)</span> 5D</td>
<td><code>ChebyshevApproximation</code></td>
<td>Full tensor is feasible; spectral convergence without knots</td>
</tr>
<tr>
<td>Function with kinks at known locations</td>
<td><strong><code>ChebyshevSpline</code></strong></td>
<td>Restores spectral convergence by splitting at singularities</td>
</tr>
<tr>
<td>High-dimensional (<span class="arithmatex">\(5+\)</span>D), general</td>
<td><code>ChebyshevTT</code></td>
<td>TT-Cross builds from <span class="arithmatex">\(O(d \cdot n \cdot r^2)\)</span> evaluations</td>
</tr>
<tr>
<td>High-dimensional, additively separable</td>
<td><code>ChebyshevSlider</code></td>
<td>Additive decomposition; cheapest build</td>
</tr>
</tbody>
</table>
<p>Use <code>ChebyshevSpline</code> when:</p>
<ul>
<li>The function has <strong>known non-smooth points</strong> (kinks, discontinuities).</li>
<li>The dimension count is low enough for full tensor grids (typically <span class="arithmatex">\(\leq 5\)</span>D).</li>
<li>You need <strong>analytical derivatives</strong> (not finite differences).</li>
<li>You want <strong>spectral accuracy</strong> on a function that would otherwise converge slowly.</li>
</ul>
<h2 id="batch-evaluation">Batch Evaluation<a class="headerlink" href="#batch-evaluation" title="Permanent link">&para;</a></h2>
<p>For evaluating many points at once, <code>eval_batch()</code> vectorises the piece-routing
step and groups points by piece:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="p">])</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="n">values</span> <span class="o">=</span> <span class="n">spline</span><span class="o">.</span><span class="n">eval_batch</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</code></pre></div>
<p>Points that fall in the same piece are batched together for efficient evaluation.</p>
<h2 id="serialization">Serialization<a class="headerlink" href="#serialization" title="Permanent link">&para;</a></h2>
<p>Save and load splines using the same pattern as other PyChebyshev classes:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1"># Save</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="n">spline</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;payoff_spline.pkl&quot;</span><span class="p">)</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="c1"># Load (no rebuild needed)</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pychebyshev</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChebyshevSpline</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="n">loaded</span> <span class="o">=</span> <span class="n">ChebyshevSpline</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;payoff_spline.pkl&quot;</span><span class="p">)</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="n">val</span> <span class="o">=</span> <span class="n">loaded</span><span class="o">.</span><span class="n">eval</span><span class="p">([</span><span class="mf">110.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</code></pre></div>
<p>The original function is <strong>not</strong> saved -- only the numerical data needed for
evaluation.  Assign a new function before calling <code>build()</code> again if a rebuild
is desired.</p>
<h2 id="limitations">Limitations<a class="headerlink" href="#limitations" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p><strong>Knots must be known a priori.</strong>  <code>ChebyshevSpline</code> does not automatically
  detect singularities.  You must know where the function is non-smooth and place
  knots accordingly.</p>
</li>
<li>
<p><strong>Build cost scales with the number of pieces.</strong>  Total evaluations are
  <span class="arithmatex">\(\text{num\_pieces} \times \prod_d n_d\)</span>.  Many knots in many dimensions
  creates many pieces: 3 knots in each of 4 dimensions means
  <span class="arithmatex">\(4^4 = 256\)</span> pieces.</p>
</li>
<li>
<p><strong>Low-dimensional only.</strong>  Like <code>ChebyshevApproximation</code>, each piece requires
  a full tensor grid.  For high-dimensional functions with kinks, a future
  extension could compose <code>ChebyshevSpline</code> with <code>ChebyshevTT</code> or
  <code>ChebyshevSlider</code>.</p>
</li>
</ul>
<h2 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<a id="pychebyshev.spline.ChebyshevSpline"></a>
    <div class="doc doc-contents first">



        <p>Piecewise Chebyshev interpolation with user-specified knots.</p>
<p>Partitions the domain into sub-intervals at interior knots and builds
an independent :class:<code>ChebyshevApproximation</code> on each piece.  Query
points are routed to the appropriate piece for evaluation.</p>
<p>This is the correct approach when the target function has known
singularities (kinks, discontinuities) at specific locations: place
knots at those locations so that each piece is smooth, restoring
spectral convergence.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>function</code>
            </td>
            <td>
                  <code><span title="callable">callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to approximate.  Signature: <code>f(point, data) -&gt; float</code>
where <code>point</code> is a list of floats and <code>data</code> is arbitrary
additional data (can be None).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_dimensions</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of input dimensions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>domain</code>
            </td>
            <td>
                  <code>list of (float, float)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Bounds [lo, hi] for each dimension.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_nodes</code>
            </td>
            <td>
                  <code>list of int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of Chebyshev nodes per dimension <em>per piece</em>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>knots</code>
            </td>
            <td>
                  <code>list of list of float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Interior knots for each dimension.  Each sub-list must be sorted
and every knot must lie strictly inside the corresponding domain
interval.  Use an empty list <code>[]</code> for dimensions with no knots.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_derivative_order</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum derivative order to pre-compute (default 2).</p>
              </div>
            </td>
            <td>
                  <code>2</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">ChebyshevSpline</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="p">[[</span><span class="mf">0.0</span><span class="p">]])</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">eval</span><span class="p">([</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">0.5</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">eval</span><span class="p">([</span><span class="o">-</span><span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">0.3</span>
</code></pre></div>











<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="pychebyshev.spline.ChebyshevSpline.num_pieces" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_pieces</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#pychebyshev.spline.ChebyshevSpline.num_pieces" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Total number of pieces (Cartesian product of per-dimension intervals).</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="pychebyshev.spline.ChebyshevSpline.total_build_evals" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">total_build_evals</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#pychebyshev.spline.ChebyshevSpline.total_build_evals" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Total number of function evaluations used during build.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="pychebyshev.spline.ChebyshevSpline.build_time" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_time</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#pychebyshev.spline.ChebyshevSpline.build_time" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Wall-clock time (seconds) for the most recent <code>build()</code> call.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h2 id="pychebyshev.spline.ChebyshevSpline.build" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#pychebyshev.spline.ChebyshevSpline.build" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Build all pieces by evaluating the function on each sub-domain.</p>
<p>Each piece is an independent :class:<code>ChebyshevApproximation</code> built
on the Cartesian product of per-dimension sub-intervals.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, print build progress.  Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychebyshev.spline.ChebyshevSpline.eval" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">eval</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">derivative_order</span><span class="p">)</span></code>

<a href="#pychebyshev.spline.ChebyshevSpline.eval" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Evaluate the spline approximation at a point.</p>
<p>Routes the query to the piece whose sub-domain contains <code>point</code>
and delegates to its
:meth:<code>~ChebyshevApproximation.vectorized_eval</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>point</code>
            </td>
            <td>
                  <code>list of float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Evaluation point in the full domain.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>derivative_order</code>
            </td>
            <td>
                  <code>list of int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Derivative order for each dimension (0 = function value).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Approximated function value or derivative.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>build()</code> has not been called.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the point is at a knot and a non-zero derivative is requested.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychebyshev.spline.ChebyshevSpline.eval_multi" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">eval_multi</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">derivative_orders</span><span class="p">)</span></code>

<a href="#pychebyshev.spline.ChebyshevSpline.eval_multi" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Evaluate multiple derivative orders at one point, sharing weights.</p>
<p>Routes to a single piece and delegates to its
:meth:<code>~ChebyshevApproximation.vectorized_eval_multi</code> so that
barycentric weight computation is shared across all requested
derivative orders.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>point</code>
            </td>
            <td>
                  <code>list of float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Evaluation point in the full domain.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>derivative_orders</code>
            </td>
            <td>
                  <code>list of list of int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Each inner list specifies derivative order per dimension.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list of float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>One result per derivative order.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>build()</code> has not been called.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the point is at a knot and a non-zero derivative is requested.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychebyshev.spline.ChebyshevSpline.eval_batch" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">eval_batch</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">derivative_order</span><span class="p">)</span></code>

<a href="#pychebyshev.spline.ChebyshevSpline.eval_batch" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Evaluate at multiple points, grouping by piece for efficiency.</p>
<p>Vectorises the piece-routing step using <code>np.searchsorted</code> and
evaluates each piece's batch via
:meth:<code>~ChebyshevApproximation.vectorized_eval_batch</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>points</code>
            </td>
            <td>
                  <code>ndarray of shape (N, num_dimensions)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Evaluation points.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>derivative_order</code>
            </td>
            <td>
                  <code>list of int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Derivative order for each dimension.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ndarray of shape (N,)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Approximated values or derivatives at each point.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>build()</code> has not been called.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychebyshev.spline.ChebyshevSpline.error_estimate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">error_estimate</span><span class="p">()</span></code>

<a href="#pychebyshev.spline.ChebyshevSpline.error_estimate" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Estimate the supremum-norm interpolation error.</p>
<p>Returns the <strong>maximum</strong> error estimate across all pieces.  Since
pieces cover disjoint sub-domains, the interpolation error at any
point is bounded by the error of the piece containing that point.
The worst-case error is therefore the maximum over all pieces
(not the sum, unlike :class:<code>ChebyshevSlider</code> where all slides
contribute to every point).</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Estimated maximum interpolation error (sup-norm).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>build()</code> has not been called.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychebyshev.spline.ChebyshevSpline.__getstate__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__getstate__</span><span class="p">()</span></code>

<a href="#pychebyshev.spline.ChebyshevSpline.__getstate__" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return picklable state, excluding the original function.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychebyshev.spline.ChebyshevSpline.__setstate__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__setstate__</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></code>

<a href="#pychebyshev.spline.ChebyshevSpline.__setstate__" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Restore state from a pickled dict.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychebyshev.spline.ChebyshevSpline.save" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

<a href="#pychebyshev.spline.ChebyshevSpline.save" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Save the built spline to a file.</p>
<p>The original function is <strong>not</strong> saved -- only the numerical data
needed for evaluation.  The saved file can be loaded with
:meth:<code>load</code> without access to the original function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span> or <span title="path">path</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Destination file path.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the spline has not been built yet.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychebyshev.spline.ChebyshevSpline.load" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#pychebyshev.spline.ChebyshevSpline.load" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Load a previously saved spline from a file.</p>
<p>The loaded object can evaluate immediately; no rebuild is needed.
The <code>function</code> attribute will be <code>None</code>.  Assign a new function
before calling <code>build()</code> again if a rebuild is desired.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span> or <span title="path">path</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the saved file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="pychebyshev.spline.ChebyshevSpline" href="#pychebyshev.spline.ChebyshevSpline">ChebyshevSpline</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The restored spline.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Warns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="UserWarning">UserWarning</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file was saved with a different PyChebyshev version.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>.. warning::</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This method uses :mod:<code>pickle</code> internally.  Pickle can execute
arbitrary code during deserialization.  <strong>Only load files you
trust.</strong></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychebyshev.spline.ChebyshevSpline.nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nodes</span><span class="p">(</span><span class="n">num_dimensions</span><span class="p">,</span> <span class="n">domain</span><span class="p">,</span> <span class="n">n_nodes</span><span class="p">,</span> <span class="n">knots</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#pychebyshev.spline.ChebyshevSpline.nodes" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Generate Chebyshev nodes for every piece without evaluating any function.</p>
<p>Use this to obtain the per-piece grid points, evaluate your function
externally, then pass the results to :meth:<code>from_values</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>num_dimensions</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of dimensions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>domain</code>
            </td>
            <td>
                  <code>list of (float, float)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lower and upper bounds for each dimension.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_nodes</code>
            </td>
            <td>
                  <code>list of int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of Chebyshev nodes per dimension <em>per piece</em>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>knots</code>
            </td>
            <td>
                  <code>list of list of float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Knot positions for each dimension (may be empty).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>'pieces'</code> : list of dicts, one per piece in C-order
(<code>np.ndindex(*piece_shape)</code>).  Each dict contains:</p>
<ul>
<li><code>'piece_index'</code> : tuple  multi-index of this piece</li>
<li><code>'sub_domain'</code> : list of (float, float)  bounds for this piece</li>
<li><code>'nodes_per_dim'</code> : list of 1-D arrays</li>
<li><code>'full_grid'</code> : 2-D array, shape <code>(prod(n_nodes), num_dimensions)</code></li>
<li><code>'shape'</code> : tuple of int</li>
</ul>
<p><code>'num_pieces'</code> : int  total number of pieces.</p>
<p><code>'piece_shape'</code> : tuple of int  per-dimension piece counts.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">info</span> <span class="o">=</span> <span class="n">ChebyshevSpline</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="p">[[</span><span class="mf">0.0</span><span class="p">]])</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;num_pieces&#39;</span><span class="p">]</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">2</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;pieces&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;sub_domain&#39;</span><span class="p">]</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">[(-1, 0.0)]</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychebyshev.spline.ChebyshevSpline.from_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_values</span><span class="p">(</span><span class="n">piece_values</span><span class="p">,</span> <span class="n">num_dimensions</span><span class="p">,</span> <span class="n">domain</span><span class="p">,</span> <span class="n">n_nodes</span><span class="p">,</span> <span class="n">knots</span><span class="p">,</span> <span class="n">max_derivative_order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#pychebyshev.spline.ChebyshevSpline.from_values" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Create a spline from pre-computed function values on each piece.</p>
<p>The resulting object is fully functional: evaluation, derivatives,
integration, rootfinding, algebra, extrusion/slicing, and
serialization all work exactly as if <code>build()</code> had been called.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>piece_values</code>
            </td>
            <td>
                  <code>list of numpy.ndarray</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function values for each piece.  Length must equal the total
number of pieces (<code>prod</code> of per-dimension piece counts).
Order follows <code>np.ndindex(*piece_shape)</code> (C-order), matching
the <code>'pieces'</code> list returned by :meth:<code>nodes</code>.  Each array
must have shape <code>tuple(n_nodes)</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_dimensions</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of dimensions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>domain</code>
            </td>
            <td>
                  <code>list of (float, float)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lower and upper bounds for each dimension.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_nodes</code>
            </td>
            <td>
                  <code>list of int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of Chebyshev nodes per dimension <em>per piece</em>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>knots</code>
            </td>
            <td>
                  <code>list of list of float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Knot positions for each dimension (may be empty).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_derivative_order</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum derivative order (default 2).</p>
              </div>
            </td>
            <td>
                  <code>2</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="pychebyshev.spline.ChebyshevSpline" href="#pychebyshev.spline.ChebyshevSpline">ChebyshevSpline</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A fully built spline with <code>function=None</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the number of pieces does not match, or any piece has
the wrong shape or contains NaN/Inf.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychebyshev.spline.ChebyshevSpline.extrude" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extrude</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></code>

<a href="#pychebyshev.spline.ChebyshevSpline.extrude" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Add new dimensions where the function is constant.</p>
<p>Each piece is extruded independently via
:meth:<code>ChebyshevApproximation.extrude</code>.  The extruded spline
evaluates identically to the original regardless of the new
coordinate(s), because Chebyshev basis functions form a partition
of unity.  The new dimension gets <code>knots=[]</code> and a single
interval <code>(lo, hi)</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code>tuple or list of tuples</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Single <code>(dim_index, (lo, hi), n_nodes)</code> or a list of such
tuples.  <code>dim_index</code> is the position in the <strong>output</strong> space
(0-indexed).  <code>n_nodes</code> must be &gt;= 2 and <code>lo &lt; hi</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="pychebyshev.spline.ChebyshevSpline" href="#pychebyshev.spline.ChebyshevSpline">ChebyshevSpline</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new, higher-dimensional spline (already built).
The result has <code>function=None</code> and <code>build_time=0.0</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the spline has not been built yet.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>dim_index</code> is not an integer.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>dim_index</code> is out of range, duplicated, <code>lo &gt;= hi</code>,
or <code>n_nodes &lt; 2</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychebyshev.spline.ChebyshevSpline.slice" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">slice</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></code>

<a href="#pychebyshev.spline.ChebyshevSpline.slice" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Fix one or more dimensions at given values, reducing dimensionality.</p>
<p>For each sliced dimension, only the pieces whose interval contains
the slice value survive.  Each surviving piece is then sliced via
:meth:<code>ChebyshevApproximation.slice</code>, which contracts the tensor
along that axis using the barycentric interpolation formula.  When
the slice value coincides with a Chebyshev node (within 1e-14),
the contraction reduces to an exact <code>np.take</code> (fast path).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code>tuple or list of tuples</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Single <code>(dim_index, value)</code> or a list of such tuples.
<code>value</code> must lie within the domain for that dimension.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="pychebyshev.spline.ChebyshevSpline" href="#pychebyshev.spline.ChebyshevSpline">ChebyshevSpline</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new, lower-dimensional spline (already built).
The result has <code>function=None</code> and <code>build_time=0.0</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the spline has not been built yet.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>dim_index</code> is not an integer.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If a slice value is outside the domain, if slicing all
dimensions, or if <code>dim_index</code> is out of range or duplicated.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychebyshev.spline.ChebyshevSpline.integrate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">integrate</span><span class="p">(</span><span class="n">dims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pychebyshev.spline.ChebyshevSpline.integrate" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Integrate the spline over one or more dimensions.</p>
<p>For full integration, sums the integrals of each piece (pieces
cover disjoint sub-domains).  For partial integration, pieces
along the integrated dimension are summed and the result is a
lower-dimensional spline.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dims</code>
            </td>
            <td>
                  <code>int, list of int, or None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dimensions to integrate out.  If <code>None</code>, integrates over
<strong>all</strong> dimensions and returns a scalar.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bounds</code>
            </td>
            <td>
                  <code>tuple, list of tuple/None, or None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sub-interval bounds for integration.  <code>None</code> (default)
integrates over the full domain of each dimension.  A single
tuple <code>(lo, hi)</code> applies to a single <em>dims</em> entry.  A list
of tuples/<code>None</code> provides per-dimension bounds with
positional correspondence to <em>dims</em>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span> or <a class="autorefs autorefs-internal" title="pychebyshev.spline.ChebyshevSpline" href="#pychebyshev.spline.ChebyshevSpline">ChebyshevSpline</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Scalar for full integration; lower-dimensional spline for
partial integration.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>build()</code> has not been called.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any dimension index is out of range or duplicated, or if
bounds are outside the domain.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychebyshev.spline.ChebyshevSpline.roots" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">roots</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fixed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pychebyshev.spline.ChebyshevSpline.roots" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Find all roots of the spline along a specified dimension.</p>
<p>Slices the spline to 1-D, then finds roots in each piece and
merges the results.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dim</code>
            </td>
            <td>
                  <code><span title="int">int</span> or None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dimension along which to find roots.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fixed</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> or None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>For multi-D, dict <code>{dim_index: value}</code> for all other dims.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sorted array of root locations in the physical domain.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>build()</code> has not been called.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <em>dim</em> / <em>fixed</em> validation fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychebyshev.spline.ChebyshevSpline.minimize" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">minimize</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fixed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pychebyshev.spline.ChebyshevSpline.minimize" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Find the minimum value of the spline along a dimension.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dim</code>
            </td>
            <td>
                  <code><span title="int">int</span> or None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dimension along which to minimize.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fixed</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> or None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>For multi-D, dict <code>{dim_index: value}</code> for all other dims.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>(value, location) : (float, float)</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>build()</code> has not been called.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <em>dim</em> / <em>fixed</em> validation fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychebyshev.spline.ChebyshevSpline.maximize" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">maximize</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fixed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pychebyshev.spline.ChebyshevSpline.maximize" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Find the maximum value of the spline along a dimension.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dim</code>
            </td>
            <td>
                  <code><span title="int">int</span> or None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dimension along which to maximize.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fixed</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> or None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>For multi-D, dict <code>{dim_index: value}</code> for all other dims.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>(value, location) : (float, float)</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>build()</code> has not been called.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <em>dim</em> / <em>fixed</em> validation fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["content.code.copy", "navigation.sections", "navigation.top", "search.highlight"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../javascripts/katex.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>